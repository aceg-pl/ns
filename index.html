<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RSS Mix Viewer</title>
<style>
  body{margin:0;padding:20px;font-family:-apple-system,system-ui,Arial;background:#f5f5f5;}
  h1{margin-bottom:10px;}
  .sites{margin-bottom:20px;text-align:center;}
  .sites img{width:24px;height:24px;margin:0 6px;cursor:pointer;vertical-align:middle;}
  .feed-list{display:grid;grid-gap:8px;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));}
  .feed-item{background:#fff;padding:6px;border-radius:6px;border:1px solid #ddd;overflow:hidden;font-size:13px;height:60px;}
  .feed-item img{width:12px;height:12px;vertical-align:middle;margin-right:4px;}
  .feed-item a{text-decoration:none;color:#007aff;}
  .feed-item span{color:#666;margin-left:4px;font-size:12px;}
</style>
</head>
<body>
<h1>ðŸ“° News</h1>
<div class="sites" id="siteIcons"></div>
<div class="feed-list" id="feedList">Loading feedsâ€¦</div>

<script>
const sites=[
  {url:'https://www.onet.pl', domain:'onet.pl'},
  {url:'https://www.wp.pl', domain:'wp.pl'},
  {url:'https://www.interia.pl', domain:'interia.pl'},
  {url:'https://www.gazeta.pl', domain:'gazeta.pl'}
];
const siteIcons=document.getElementById('siteIcons');
sites.forEach((site,i)=>{
  const img=document.createElement('img');
  img.src=`https://www.google.com/s2/favicons?domain=${site.domain}&sz=24`;
  img.onclick=()=>window.open(site.url,'_blank');
  siteIcons.appendChild(img);
});

const feeds=[
  'https://wiadomosci.onet.pl/.feed',
  'https://wiadomosci.gazeta.pl/pub/rss/wiadomosci.htm',
  'https://www.polsatnews.pl/rss/wszystkie.xml',
  'https://wiadomosci.wp.pl/rss.xml',
  'https://feeds.bbci.co.uk/polska/rss.xml',
  'https://wydarzenia.interia.pl/feed'
];
const proxy='https://api.allorigins.win/get?url=';

const feedList=document.getElementById('feedList');
const items=[];

Promise.all(feeds.map(feedURL=>
  fetch(proxy + encodeURIComponent(feedURL))
    .then(r=>r.json())
    .then(data=>{
      const parser=new DOMParser();
      const xml=parser.parseFromString(data.contents,"application/xml");
      const entries=Array.from(xml.querySelectorAll("item, entry"));
      entries.forEach(e=>{
        items.push({
          title:e.querySelector("title")?.textContent || "No title",
          link:e.querySelector("link")?.textContent || e.querySelector("link")?.getAttribute("href") || "#",
          date:e.querySelector("pubDate")?.textContent || e.querySelector("updated")?.textContent || new Date().toISOString()
        });
      });
    }).catch(()=>{})
)).then(()=>{
  items.sort((a,b)=>new Date(b.date)-new Date(a.date));
  feedList.innerHTML='';
  items.slice(0,100).forEach(e=>{
    const entry=document.createElement('div');
    entry.className='feed-item';
    const a=document.createElement('a'); a.href=e.link; a.target='_blank';
    const img=document.createElement('img'); img.src=`https://www.google.com/s2/favicons?domain=${new URL(e.link).hostname}&sz=16`;
    let tText=e.title.split(' ').slice(0,14).join(' '); if(e.title.split(' ').length>14) tText+='â€¦';
    const span=document.createElement('span');
    const r=new Date(e.date), d=new Date();
    span.textContent=' '+((d-r)/36e5<24 ? `${String(r.getHours()).padStart(2,'0')}:${String(r.getMinutes()).padStart(2,'0')}` : `${String(r.getDate()).padStart(2,'0')}/${String(r.getMonth()+1).padStart(2,'0')}`);
    a.appendChild(img); a.appendChild(document.createTextNode(tText)); a.appendChild(span);
    entry.appendChild(a); feedList.appendChild(entry);
  });
});
</script>
</body>
</html>
